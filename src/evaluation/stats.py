# -*- coding: utf-8 -*-
"""stats.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/15u-Zokq4yiDXfDRdE39pZYisLyi8nwnf
"""

"""
Statistical evaluation utilities for gaze-informed MT.

This module implements a paired Wilcoxon signed-rank test
and descriptive statistics for baseline vs gaze-informed systems.
"""

from typing import Dict
import numpy as np
from scipy.stats import wilcoxon


def wilcoxon_test(
    baseline: list[float],
    gaze: list[float],
) -> Dict[str, float]:
    """
    Paired Wilcoxon signed-rank test for baseline vs gaze-informed scores.

    Parameters
    ----------
    baseline : list of float
        Baseline system scores (e.g. mean reading difficulty).
    gaze : list of float
        Gaze-informed system scores.

    Returns
    -------
    dict
        Dictionary with test statistic and p-value.
    """
    baseline = np.asarray(baseline, dtype=float)
    gaze = np.asarray(gaze, dtype=float)

    if baseline.shape != gaze.shape:
        raise ValueError("Baseline and gaze arrays must have the same shape")

    stat, p_value = wilcoxon(baseline, gaze)

    return {
        "statistic": float(stat),
        "p_value": float(p_value),
    }


def summarize_differences(
    baseline: list[float],
    gaze: list[float],
) -> Dict[str, float]:
    """
    Compute descriptive statistics for baseline vs gaze-informed scores.

    Returns
    -------
    dict
        Mean baseline score, mean gaze score, mean difference, and std difference.
    """
    baseline = np.asarray(baseline, dtype=float)
    gaze = np.asarray(gaze, dtype=float)

    diffs = gaze - baseline

    return {
        "baseline_mean": float(np.mean(baseline)),
        "gaze_mean": float(np.mean(gaze)),
        "mean_difference": float(np.mean(diffs)),
        "std_difference": float(np.std(diffs)),
    }